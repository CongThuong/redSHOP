!function(e){var i=window.redSHOP||{};i.Module=i.Module||{},i.Module.Filter=i.Module.Filter||{},i.Module.Filter.form=null,i.Module.Filter.options={},i.Module.Filter.resetMode=!1,i.Module.Filter.setup=function(t){i.Module.Filter.options=t,i.Module.Filter.form=e("#redproductfinder-form-"+i.Module.Filter.options.domId),i.Module.Filter.checkList(),i.Module.Filter.form.find('input[name="keyword-manufacturer"]').on("keyup",function(){var t=i.Module.Filter.options.manufacturers,l=e(this).val(),r=[],o=e('input[name="check_list"]').val(),n=e.parseJSON(o);e.each(t,function(e,i){i.name.toLowerCase().indexOf(l.toLowerCase())>-1&&r.push(i)});var a="";e.each(r,function(i,t){if(Object.keys(t).length>0){var l="";-1!=e.inArray(t.manufacturer_id,n)&&(l='checked="checked"'),a+='<li style="list-style: none"><label>',a+='<span class="taginput" data-aliases="'+t.id+'">',a+='<input type="checkbox" '+l+' value="'+t.id+'" name="redform[manufacturer][]" />',a+="</span>",a+='<span class="tagname">'+t.name+"</span>",a+="</label></li>"}}),i.Module.Filter.form.find("#manu #manufacture-list").html(""),i.Module.Filter.form.find("#manu #manufacture-list").append(a),i.Module.Filter.checkList()}),i.Module.Filter.form.find('[type="checkbox"]').each(function(){i.Module.Filter.checkClick(e(this))}),i.Module.Filter.form.html(function(){e("span.label_alias").click(function(){e(this).hasClass("active")?e(this).removeClass("active").next("ul.collapse").removeClass("in"):(i.Module.Filter.form.find("ul.collapse.in").removeClass("in").prev("span").removeClass("active"),e(this).addClass("active").next("ul.collapse").addClass("in"))}),i.Module.Filter.rangeSlide(t.rangeMin,t.rangeMax,t.currentMin,t.currentMax,i.Module.Filter.submitFormAjax)}),t.showKeyword&&e("#"+t.domId+"-keyword").on("keypress",function(e){return 13!==e.keyCode||(i.Module.Filter.submitFormAjax(),!1)}),t.showClearBtn&&i.Module.Filter.form.find("#clear-btn").on("click",function(l){l.preventDefault(),i.Module.Filter.resetMode=!0,i.Module.Filter.form.find('input[type="checkbox"]').prop("checked",!1),i.Module.Filter.form.find('input[type="checkbox"]').each(function(){i.Module.Filter.checkClick(e(this))}),i.Module.Filter.form.find('input[name="redform[filterprice][min]"]').val(t.rangeMin),i.Module.Filter.form.find('input[name="redform[filterprice][max]"]').val(t.rangeMax),e("#"+t.domId+"-keyword").val(""),i.Module.Filter.rangeSlide(t.rangeMin,t.rangeMax,t.currentMin,t.currentMax,i.Module.Filter.submitFormAjax),i.Module.Filter.resetMode=!1,i.Module.Filter.submitFormAjax(null)})},i.Module.Filter.checkList=function(){var t=[];i.Module.Filter.form.find("#manu #manufacture-list input").on("change",function(){t.push(e(this).val()),i.Module.Filter.submitForm(this)}),e('input[name="check_list"]').val(JSON.stringify(t))},i.Module.Filter.checkClick=function(i){!0===e(i).prop("checked")?e(i).prev(".icon").addClass("active"):e(i).prev(".icon").removeClass("active")},i.Module.Filter.rangeSlide=function(t,l,r,o,n){e.ui.slider.prototype.widgetEventPrefix="slider",i.Module.Filter.form.find("#slider-range").slider({range:!0,min:t,max:l,step:1,values:[r,o],slide:function(e,t){i.Module.Filter.form.find('[name="redform[filterprice][min]"]').attr("value",t.values[0]),i.Module.Filter.form.find('[name="redform[filterprice][max]"]').attr("value",t.values[1])},change:function(){n&&"function"==typeof n&&(e('input[name="limitstart"]').val(0),n())}})},i.Module.Filter.submitFormAjax=function(){!1===i.Module.Filter.resetMode&&e.ajax({type:"POST",url:i.RSConfig._("SITE_URL")+"index.php?option=com_redshop&task=search.findProducts",data:i.Module.Filter.form.serialize(),beforeSend:function(){e("#wait").css("display","block")},success:function(i){var t=e("#main #redshopcomponent");t.length||(t=jQuery("#redshopcomponent")),t.html(i),e("select").select2(),window.history.pushState("","",e(e.parseHTML(i)).find("#new-url").text())},complete:function(){e("#wait").css("display","none"),i.Module.Filter.options.isRestricted&&restricted(i.Module.Filter.form.serialize(),e('input[name="pids"]').val(),i.Module.Filter.options.moduleParams)}})},i.Module.Filter.submitForm=function(){i.Module.Filter.form.find('input[name="limitstart"]').val(0),i.Module.Filter.submitFormAjax()}}(jQuery);