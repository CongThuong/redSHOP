!function(e){var i=window.redSHOP||{};i.Module=i.Module||{},i.Module.Filter=i.Module.Filter||{},i.Module.Filter.form=null,i.Module.Filter.options={},i.Module.Filter.setup=function(t){i.Module.Filter.options=t,i.Module.Filter.form=e("#redproductfinder-form-"+i.Module.Filter.options.domId),i.Module.Filter.checkList(),i.Module.Filter.form.find('input[name="keyword-manufacturer"]').on("keyup",function(){var t=i.Module.Filter.options.manufacturers,l=e.parseJSON(t),r=e(this).val(),n=[],o=e('input[name="check_list"]').val(),a=e.parseJSON(o);e.each(l,function(e,i){i.name.toLowerCase().indexOf(r.toLowerCase())>-1&&n.push(i)});var u="";e.each(n,function(i,t){if(Object.keys(t).length>0){if(-1!=e.inArray(t.manufacturer_id,a))var l='checked="checked"';else l="";u+='<li style="list-style: none"><label>',u+='<span class="taginput" data-aliases="'+t.id+'">',u+='<input type="checkbox" '+l+' value="'+t.id+'" name="redform[manufacturer][]" />',u+="</span>",u+='<span class="tagname">'+t.name+"</span>",u+="</label></li>"}}),i.Module.Filter.form.find("#manu #manufacture-list").html(""),i.Module.Filter.form.find("#manu #manufacture-list").append(u),i.Module.Filter.checkList()}),i.Module.Filter.form.find('[type="checkbox"]').each(function(){i.Module.Filter.checkClick(e(this))}),i.Module.Filter.form.html(function(){e("span.label_alias").click(function(t){e(this).hasClass("active")?e(this).removeClass("active").next("ul.collapse").removeClass("in"):(i.Module.Filter.form.find("ul.collapse.in").removeClass("in").prev("span").removeClass("active"),e(this).addClass("active").next("ul.collapse").addClass("in"))}),i.Module.Filter.rangeSlide(t.rangeMin,t.rangeMax,t.currentMin,t.currentMax,i.Module.Filter.submitFormAjax)}),t.showKeyword&&e("#"+t.domId+"-keyword").on("keypress",function(e){return 13!==e.keyCode||(i.Module.Filter.submitFormAjax(),!1)}),t.showClearBtn&&i.Module.Filter.form.find("#clear-btn").on("click",function(l){l.preventDefault(),i.Module.Filter.form.find('input[type="checkbox"]').prop("checked",!1),i.Module.Filter.form.find('input[type="checkbox"]').each(function(){i.Module.Filter.checkClick(e(this))}),i.Module.Filter.form.find('input[name="redform[filterprice][min]"]').val(t.rangeMin),i.Module.Filter.form.find('input[name="redform[filterprice][max]"]').val(t.rangeMax),e("#"+t.domId+"-keyword").val(""),i.Module.Filter.rangeSlide(t.rangeMin,t.rangeMax,t.currentMin,t.currentMax),i.Module.Filter.submitFormAjax(null)})},i.Module.Filter.checkList=function(){var t=[];i.Module.Filter.form.find("#manu #manufacture-list input").on("change",function(){t.push(e(this).val())}),e('input[name="check_list"]').val(JSON.stringify(t))},i.Module.Filter.checkClick=function(i){!0===e(i).prop("checked")?e(i).prev(".icon").addClass("active"):e(i).prev(".icon").removeClass("active")},i.Module.Filter.rangeSlide=function(t,l,r,n,o){e.ui.slider.prototype.widgetEventPrefix="slider",i.Module.Filter.form.find("#slider-range").slider({range:!0,min:t,max:l,step:1,values:[r,n],slide:function(e,t){i.Module.Filter.form.find('[name="redform[filterprice][min]"]').attr("value",t.values[0]),i.Module.Filter.form.find('[name="redform[filterprice][max]"]').attr("value",t.values[1])},change:function(i,t){o&&"function"==typeof o&&(e('input[name="limitstart"]').val(0),o())}})},i.Module.Filter.submitFormAjax=function(){e.ajax({type:"POST",url:i.RSConfig._("SITE_URL")+"index.php?option=com_redshop&task=search.findProducts",data:i.Module.Filter.form.serialize(),beforeSend:function(){e("#wait").css("display","block")},success:function(i){var t=e("#main #redshopcomponent");t.length||(t=jQuery("#redshopcomponent")),t.html(i),e("select").select2(),url=e(e.parseHTML(i)).find("#new-url").text(),window.history.pushState("","",url)},complete:function(){if(e("#wait").css("display","none"),i.Module.Filter.options.isRestricted){var t=jQuery('input[name="pids"]').val();restricted(i.Module.Filter.form.serialize(),t,i.Module.Filter.options.moduleParams)}}})},i.Module.Filter.submitForm=function(){i.Module.Filter.form.find('input[name="limitstart"]').val(0),i.Module.Filter.submitFormAjax()}}(jQuery);